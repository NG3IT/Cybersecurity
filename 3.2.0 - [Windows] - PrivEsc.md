# Methodology

1. Enumerate the current user's privileges and resources it can access

2. If the antivirus software allows it, run an automated enumeration script such as winPEAS or PowerUp.ps1

3. If the initial enumeration and scripts do not uncover an obvious strategy, try a different approach


---

# Enumeration

## User enumeration

```powershell
# List current user's privileges
$ whoami /priv

# List users
$ net users

# Details about user
$ net user <user>
$ net user Administrator

# User(s) logged in simultaneously
$ qwinsta
$ query session

# List locals groups
$ net localgroup

# Details about group
$ net localgroup <groupname>
$ net localgroup Adlinistrators
```

## System information

```powershell
# Get informationsss
$ systeminfo

# OS Version
$ systeminfo | findstr /B /C:"OS Name" /C:"OS Version"

# Hostanme 
$ hostname
```

## Search files

```powershell
# Find files with this pattern : password and .txt extension
findstr /si password *.txt

# Good extensions are : .txt, .xml, .ini, .config, .xls
```

## Patch level

```powershell
# Get patch applied on the system
$ wmic qfe get Caption,Description,HotFixID,InstalledOn
```

## Network connections

```powershell
# List all listened ports
$ netstat -ano
```

## Scheduled tasks

```powershell
# List all scheduled tasks
$ schtasks /query /fo LIST /v
```

## Drivers

```powershell
# List all installed drivers
$ driverquery
```
