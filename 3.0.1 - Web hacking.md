# Web Hacking 

[TryHackMe's room](https://tryhackme.com/paths)

## Sumary

- [Content Discovery](https://github.com/NG3IT/Sec/blob/main/3.0.1%20-%20Web%20hacking.md#content-discovery)
- [Subdomain](https://github.com/NG3IT/Sec/blob/main/3.0.1%20-%20Web%20hacking.md#subdomain)
- [Auhnetication Bypass](https://github.com/NG3IT/Sec/blob/main/3.0.1%20-%20Web%20hacking.md#authentication-bypass)
- [IDOR]()
- [File Inclusion]()

---

## Content Discovery

Manually / Automated / OSINT

<br>

### Manually

Few things important to discover :
- Robotx.txt
- Favicon -> [Favicon list](https://wiki.owasp.org/index.php/OWASP_favicon_database)

```bash
# If favicon is present
# Check source code and get the md5 sum of favicon
$ curl <favicon_url> | md5sum
# Check if the md5sum is present on favicon's list
```

- Sitemap.xml
- HTTP Headers (Informations about softwares used)

```bash
$ curl <url> -v
```

- Check frameworks (default credentials, version, etc.)
- Google Dorking

```bash
# Examples
site -> site:site.com
inurl -> inurl:<pattern>
         inurl:admin
filetype -> filetype:<filetype>
                     pdf
intitle -> intitle:<pattern>
                   admin
```

- Wappalazer
- Wayback machine (old content) -> [Wayback](https://archive.org/web/)
- GitHub
- S3 Buckets

```bash
# Public S3
# http(s)://{name}.s3.amazonaws.com
# http(s)://mysite.s3.amazonaws.com
# http(s)://mysite-www.s3.amazonaws.com
# http(s)://mysite-asstes.s3.amazonaws.com
# http(s)://mysite-public.s3.amazonaws.com
# http(s)://mysite-private.s3.amazonaws.com
```

<br>

### Automated

```bash
# Feroxbuster

# dirb
dirb <url> <wordlist>

# gobuster
$ gobuster dir --url <url> -w <wordlist>
```

#### Gobuster

```bash
$ gobuster dir -u <url> -w <wordlist>
$ gobuster dir -u <url> -w <wordlist> -x <extension_file>
```

<br>

---

## Subdomain

Brute force / OSINT / Virtualhost

<br>

### OSINT - SSL/TLS Certificates

Check Certificate Transparency logs -> https://crt.sh/
                                       https://ui.ctsearch.entrust.com/ui/ctsearchui
                                       
### OSINT - Search Engines

```bash
# Search domains
site:*<.domain.com>
site:*.tryhackme.com
```

### DNS Bruteforce

```bash
$ dnsrecon
```

### OSINT - Sublisterl

Automated discovery with [Sublister](https://github.com/aboul3la/Sublist3r)

### VirtualHosts

```bash
# Bruteforce Vitualhosts
$ ffuf -w <wordlist> -H "Host: FUZZ.<subdomain>.<domain>" -u <url>
$ ffuf -w /usr/share/wordlists/SecLists/Discovery/DNS/namelist.txt -H "Host: FUZZ.domain.com" -u http://MACHINE_IP
```

<br>

---

## Authentication Bypass

### Username Enumeration

Identify the error messages (username does not exists / wrong passwords / etc.)

```bash
# Example with error message : "username already exists"
$ ffuf -w <wordlist> -X <METHOD> -d <data> -H <Header> -u <url> -mr <error_message>
$ ffuf -w /usr/share/wordlists/SecLists/Usernames/Names/names.txt -X POST -d "username=FUZZ&email=x&password=x&cpassword=x" -H "Content-Type: application/x-www-form-urlencoded" -u http://10.10.113.42/customers/signup -mr "username already exists"
```

### Brute Force

Brute force login page

```bash
# Example
$ ffuf -w <wordlist_W1>:W1,<wordlist_W2>:W2 -X POST -d <data> -H <Header> -u <url> -fc <status_code>
$ ffuf -w valid_usernames.txt:W1,/usr/share/wordlists/SecLists/Passwords/Common-Credentials/10-million-password-list-top-100.txt:W2 -X POST -d "username=W1&password=W2" -H "Content-Type: application/x-www-form-urlencoded" -u http://10.10.113.42/customers/login -fc 200
```

### Logic flaw

Inspect authentication mecanisms and try to bypass logic flaw

### Cookie Tampering

Cookies format can be plaintext, hashed or encoded.

<br>

---

## IDOR (Insecure Direct Object Reference)

Get objects with input data insecure

### Where are they located ?

URL / AJAX / JS

```bash
# Examples
http://mywebsite.com/order/1000/status -> http://mywebsite.com/order/1/status
http://mywebsite.com/index.php?id=30 -> http://mywebsite.com/index.php?id=1
```

### Encoded value

```bash
# Base64 example
e2lkPTF9 -> {id=1} -> {id=2} -> e2lkPTJ9
```

### Hashed value 

```
# MD5 example
202cb962ac59075b964b07152d234b70 -> 123
```

### Predictable / Unpredictable values

Predictable -> The methode is as follow : create two accounts and check the ID for determine pattern

Unpredictable -> The methode is as follow : create two accounts and check if you can see information about the second account as the first

<br>

---

## File Inclusion

