

## Discovery of hosts alive :

### Layer 2

Arp scan (without port scan)
```bash
sudo nmap -PR -sn <target>/<cidr>
```

ICMP request scan (without port scan)
```bash
sudo nmap -PE -sn <target>/<cidr>
```

### Layer 3

Timestamp ICMP scan (without port scan)
```bash
sudo nmap -PP -sn <target>/<cidr>
```

Netmask ICMP request scan (without port scan)
```bash
sudo nmap -PM -sn <target>/<cidr>
```

Arp-scan tool (local network) 
```bash
arp-scan -I <interface> -l
```

### Layer 4

TCP SYN ping
```bash
sudo nmap -PS<port_numer> -sn <target>/<cidr>
```

TCP ACK ping 
```bash
sudo nmap -PA<port_numer> -sn <target>/<cidr>
```

UDP ping 
```bash
sudo nmap -PU<port_numer> -sn <target>/<cidr>
```

---

## Simple scan

Treat all hosts as online (skip host discovery)
```bash
nmap -Pn <target>
```

---

## Nmap six states result :

1. Open : Service is listening.
2. Closed : No service is listening.
3. Filtered : Port can be open or closed because is not accessible. Probably cause by FW.
4. Unfiltered :  Port is available. Often met when it is a ACK scan (-sA switch).
5. Open|Filtered : Nmap can't determine if port is open or filtered
6. Cload|Filtered : Nmap can't determine if port is closed or filtered

---

## TCP Connect Scan

SYN -> SYN/ACK -> ACK and RST/ACK (will reset the connection after complete a 3 handshake TCP)

```bash
$ sudo nmap -sT <IP>
```

---

## TCP SYN Scan

SYN -> SYN/ACK -> RST (will not complete a 3 handshake TCP. That result to less chance that scan to be logged)

```bash
$ sudo nmap -sS <IP>
```

---

## UDP Scan

Just UDP packets send. 

UDP Packet -> ICMP Type 3, Code 3 (will generated an ICMP packet destination unreachable for every closed port)

```bash
$ sudo nmap -sU <IP>
```

---

## Scan Timing

1. paranoid (0) -> use for avoid IDS alertes
2. sneaky(1) -> use for avoid IDS alertes
3. polite (2)
4. normal (3)
5. aggressive (4)
6. insane (5)

```bash
--max-rate <number>
```

THe --max-rate switch can set to specify a maximum packets sent per second. (example -> --max-rate 10)

---
